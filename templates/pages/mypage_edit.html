{% extends "base/layout.html" %}
{% block title %}プロフィール編集 | リサーチナビ{% endblock %}
{% block content %}

<style>
  .edit-wrap {
    max-width: 600px;
    margin: 8vh auto;
    padding: 2rem;
    background: #fff;
    border-radius: 1rem;
    box-shadow: 0 6px 24px rgba(0,0,0,.08);
  }
  .edit-wrap h1 {
    font-size: 1.6rem;
    margin-bottom: 1.5rem;
    text-align: center;
    color: #dc2626;
  }
  .edit-form {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
  .edit-form label {
    font-size: 0.9rem;
    font-weight: 600;
    color: #374151;
  }
  .edit-form input {
    width: 100%;
    padding: 0.8rem;
    border-radius: 0.5rem;
    border: 1px solid #d1d5db;
    font-size: 1rem;
  }
  .btn-save, .btn-back {
    margin-top: 1rem;
    padding: 0.9rem;
    border: none;
    border-radius: 0.6rem;
    font-weight: bold;
    cursor: pointer;
  }
  .btn-save {
    background: #dc2626; color: #ffeb3b;
  }
  .btn-save:hover { opacity: 0.9; }
  .btn-back {
    background: transparent; border: 1px solid #dc2626; color: #dc2626;
  }
  .btn-back:hover { background: #dc2626; color: #ffeb3b; }
  .flash {
    margin-bottom: 1rem;
    padding: .8rem;
    border-radius: .5rem;
    font-size: .9rem;
    background: #d1fae5;
    color: #065f46;
  }
</style>

<div class="edit-wrap">
  <h1>プロフィール編集</h1>

  <!-- フラッシュメッセージ -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, msg in messages %}
        <div class="flash">{{ msg }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <form method="post" class="edit-form">
    <div>
      <label for="name">名前</label>
      <input type="text" id="name" name="name" value="{{ user['ユーザー名'] }}" required>
    </div>
    <div>
      <label for="kana">ふりがな</label>
      <input type="text" id="kana" name="kana" value="{{ user['ふりがな'] }}">
    </div>
    <div>
      <label for="email">メールアドレス</label>
      <input type="email" id="email" name="email" value="{{ user['メールアドレス'] }}">
    </div>
    <div>
      <label for="dept">部署</label>
      <input type="text" id="dept" name="dept" value="{{ user['部署'] }}">
    </div>
    <div>
      <label for="phone">電話番号</label>
      <input type="text" id="phone" name="phone" value="{{ user['電話番号'] }}">
    </div>
    <div>
      <label for="mobile">携帯番号</label>
      <input type="text" id="mobile" name="mobile" value="{{ user['携帯番号'] }}">
    </div>
    <div>
      <label for="ref_no">紹介者NO</label>
      <input type="text" id="ref_no" name="ref_no" value="{{ user['紹介者NO'] }}">
    </div>
    <div>
      <label for="password">パスワード変更（空欄なら変更なし）</label>
      <input type="password" id="password" name="password">
    </div>
    <button type="submit" class="btn-save">保存する</button>
  </form>

  <!-- 戻るボタン -->
  <form action="{{ url_for('mypage', user_id=user['ID']) }}" method="get">
    <button type="submit" class="btn-back">👈 マイページに戻る</button>
  </form>
</div>

{% endblock %}
